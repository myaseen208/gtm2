% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/dorfman.R
\name{dorfman}
\alias{dorfman}
\title{Dorfman Group Testing Decoder}
\usage{
dorfman(Y.true, Se, Sp, c)
}
\arguments{
\item{Y.true}{Numeric vector (n x 1) of true binary statuses (1=positive, 0=negative)}

\item{Se}{Numeric vector of length 2: (group sensitivity, individual sensitivity)}

\item{Sp}{Numeric vector of length 2: (group specificity, individual specificity)}

\item{c}{Integer group size (must divide length(Y.true))}
}
\value{
List with:
\describe{
  \item{Z}{Test results matrix (J x (c+3)) where columns are:
            [Test result, Group size, Test type (1=group, 2=individual), Sample indices]}
  \item{Y}{Individual results matrix (n x 4) where columns are:
            [Test result, Test type, Group test ID, Individual test ID]}
}
}
\description{
Implements two-stage Dorfman group testing algorithm with sensitivity and specificity considerations.
}
\details{
The function performs:
\enumerate{
  \item Group testing: Samples are pooled into groups of size \code{c} and tested
  \item Individual testing: If a group tests positive, all members are tested individually
}
The probability models used:
\deqn{P(Z_g = 1|Y_g) = \begin{cases}
Se[1] & \text{if } \sum Y_g > 0 \\
1-Sp[1] & \text{otherwise}
\end{cases}}
\deqn{P(Z_i = 1|Y_i) = \begin{cases}
Se[2] & \text{if } Y_i = 1 \\
1-Sp[2] & \text{otherwise}
\end{cases}}
where \eqn{Z_g} is group test result, \eqn{Z_i} is individual test result, and \eqn{Y_g}, \eqn{Y_i} are true statuses.
}
\examples{
set.seed(123)
Y.true <- rbinom(10, 1, 0.3)
result <- dorfman(Y.true, c(0.95, 0.98), c(0.98, 0.99), 2)
result
}
